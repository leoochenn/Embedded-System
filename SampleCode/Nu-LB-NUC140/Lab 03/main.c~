/*
   need this to work
Library:
gpio.c
retarget.c

User:
Seven_Segment.c
*/
//
// LCD_keypad : 3x3 keypad input and display on LCD
//
// EVB : Nu-LB-NUC140
// MCU : NUC140VE3CN  (LQPF-100)
#include <stdio.h>
#include "NUC100Series.h"
#include "MCU_init.h"
#include "SYS_init.h"
#include "LCD.h"
#include "Scankey.h"
#include "Seven_Segment.h"
#include <stdlib.h>
#include <string.h>


// this delay is for sound.
#define delay 1000000

uint8_t numBulls(uint8_t guess[], uint8_t code[]);
uint8_t numCows(uint8_t guess[], uint8_t code[]);
void winSound(void);
void Buzz(int);
int LENGTH = 4;
void Display_7seg(uint16_t value);
void getUserInput(uint8_t, uint8_t*, char*, int*);

unsigned char GameTitle[128*8] ={
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xE0,0x3C,0x02,0xFE,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x7E,0x02,0x02,0x0E,0xF0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0x80,0x00,0x00,0x07,0x1C,0x10,0x30,0x20,0x20,0x20,0x20,0x20,0xE0,0x60,0x20,0x30,0x10,0x18,0x08,0x08,0x08,0x04,0x04,0x04,0x06,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x06,0x04,0x04,0x08,0x08,0x18,0x10,0x10,0x20,0x40,0xC0,0xC0,0x40,0x60,0x20,0x30,0x18,0x0E,0x03,0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x07,0x38,0x60,0x40,0x40,0x40,0x40,0x40,0x40,0x78,0xC6,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x9F,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0xC0,0x80,0x9F,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x06,0xFC,0x40,0x40,0x60,0x20,0x20,0x30,0x10,0x18,0x0E,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x07,0x1C,0x70,0xC0,0x80,0x80,0xE0,0x38,0x0C,0x06,0x03,0x01,0x00,0x00,0x00,0x00,0x00,0x7C,0x00,0x00,0x00,0x00,0xFC,0x00,0x00,0x00,0x00,0x00,0x07,0x0C,0xF8,0x80,0xC0,0x60,0x30,0x10,0x0C,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x0E,0x08,0x18,0x10,0x20,0x20,0x60,0x40,0x40,0x40,0xC0,0x80,0x80,0x80,0x80,0x80,0x80,0xC0,0x40,0x40,0x20,0x38,0x0E,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x40,0x40,0x40,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xE0,0x00,0x00,0x00,0xE0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xE0,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x80,0x40,0x40,0x40,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7F,0x44,0x44,0x44,0x6F,0x38,0x00,0x00,0x3F,0x40,0x40,0x40,0x7F,0x00,0x00,0x00,0x7F,0x00,0x00,0x00,0x7F,0x00,0x00,0x40,0x47,0x49,0x49,0x31,0x00,0x00,0x00,0x00,0x30,0x78,0x49,0x49,0x2B,0x7C,0x00,0x00,0x7F,0x02,0x01,0x01,0x7F,0x00,0x00,0x08,0x3E,0x41,0x41,0x41,0x3F,0x00,0x00,0x00,0x00,0x00,0x0C,0x3F,0x60,0x40,0x40,0x40,0x20,0x00,0x08,0x3E,0x41,0x41,0x41,0x23,0x1E,0x00,0x01,0x1E,0x60,0x70,0x07,0x07,0x70,0x60,0x1C,0x03,0x00,0x40,0x47,0x49,0x49,0x31,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};

unsigned char Win[128*8] ={
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x00,0x00,0x00,0x00,0x80,0x00,0x00,0x00,0x00,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x06,0x18,0xF0,0x0C,0x03,0x00,0x20,0xF8,0x04,0x04,0x04,0x8C,0x78,0x00,0x00,0xFC,0x00,0x00,0x00,0xFC,0x00,0x00,0x00,0x00,0x00,0x04,0x78,0x80,0xC0,0x1C,0x1C,0xC0,0x80,0x70,0x0C,0x00,0x20,0xF8,0x04,0x04,0x04,0x8C,0x78,0x00,0x00,0xFC,0x08,0x04,0x04,0xFC,0x00,0x00,0x00,0x00,0xBF,0x00,0x00,0x00,0x00,0xBF,0x00,0x00,0x00,0x00,0xBF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x00,0x00,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x01,0x00,0x00,0x80,0x80,0x81,0x80,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0xF0,0x18,0x0C,0x06,0x03,0xC1,0x71,0x3C,0x23,0x21,0x61,0xC0,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x80,0x80,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0xE0,0x38,0x08,0x0C,0x06,0x02,0x02,0x81,0x81,0x81,0x00,0x00,0x00,0x00,0x00,0x0E,0x0F,0x1F,0x1F,0x1F,0x1F,0x3F,0x3F,0x3F,0x3E,0x1E,0x10,0x00,0x00,0x00,0x01,0x03,0x06,0x04,0x04,0x06,0x01,0x00,0x00,0x00,0x04,0x00,0x00,0x03,0x0E,0x18,0x10,0xB0,0xE0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7C,0xFC,0x7E,0x72,0x03,0x01,0x01,0x00,0x00,0x01,0x03,0x02,0x02,0x02,0x02,0x01,0xFF,0x80,0x00,0x00,0x00,0x00,0x3E,0xFF,0xFF,0xFF,0xFF,0xFF,0xFC,0xE0,0xC0,0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x60,0xF0,0xF0,0xE0,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0xC0,0x70,0x0E,0x04,0x04,0x0C,0x08,0x08,0x18,0x10,0x10,0x1C,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x03,0x02,0x06,0x04,0x04,0xC4,0x7D,0x01,0x01,0x01,0x81,0xF1,0x70,0xD0,0x90,0x10,0x10,0x10,0x10,0x08,0x08,0x0E,0x8E,0x7F,0x0F,0x0F,0x0F,0x3F,0xEF,0x06,0x00,0x00,0x00,0xFF,0x81,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x1F,0x18,0x18,0x18,0x0E,0x03,0x00,0x00,0x00,0x01,0x07,0x04,0x07,0x01,0x07,0x04,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x03,0x3E,0x30,0x38,0x38,0x3D,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};





int main(void)
{
char Text[16] = "Guess:          ";
char Text2[16] = "              ";
char Text3[16] = "Guess #:      ";
	char Text4[16] = "input number:";
	char Text5[16] = "            ";
uint8_t code[4] = {0, 0, 0, 0};
int Code = 2694;
uint8_t keyin=0;
uint8_t numB=0;
uint8_t numC=0;
uint8_t guess[4] = {0};
uint8_t numGuesses = 0;
//int number = rand() % 9000 + 1000;
int i = 0;
int j;


//	system initial.
SYS_Init();
init_LCD();
clear_LCD();
OpenKeyPad();              // initialize 3x3 keypad
GPIO_SetMode(PB, BIT11, GPIO_MODE_OUTPUT);
GPIO_SetMode(PC, BIT12, GPIO_MODE_OUTPUT);


flage:
//	initial all variables.
keyin=0;
numB=0;
numC=0;
guess[0] = 0;
guess[1] = 0;
guess[2] = 0;
guess[3] = 0;
code[0] = 0;
code[1] = 0;
code[2] = 0;
code[3] = 0;
numGuesses = 0;

//	display game title.
draw_LCD(GameTitle);   // draw Game Title scene
// Buzz!!
Buzz(5);
for (i=0;i<3;i++) CLK_SysTickDelay(1000000);
clear_LCD();

//	user input secrete code.
	print_Line(0, Text4);
	for (i=0;i<3;i++) CLK_SysTickDelay(1000000);
	getUserInput(keyin, code, Text5, &Code);
	clear_LCD();
	

while (numBulls(guess, code) != LENGTH) {
i=0;
guess[0]=0;guess[1]=0;guess[2]=0;guess[3]=0;
numGuesses++;
sprintf(Text3 +10,"%d", numGuesses);
print_Line(0,Text3); // print title
while(1){
while(keyin == 0){
keyin = ScanKey();
}
guess[i]=keyin;
sprintf(Text+7,"%d%d%d%d", guess[0],guess[1],guess[2],guess[3]); // print scankey input to string
print_Line(1, Text);         // display string on LCD
CLK_SysTickDelay(500000);   // delay
keyin =0;
++i;
if(i==4){
	break;
}
}

numB = numBulls(guess, code);
numC = numCows(guess, code);
print_Line(2,"Bulls:   Cows: "); // print title
sprintf(Text2,"   %d       %d", numB,numC);
print_Line(3,Text2);
//Buzz(numC);

}



draw_LCD(Win);
winSound();
//for (i=0;i<3;i++) CLK_SysTickDelay(1000000);


for (j = 0; j < 50; j++) Display_7seg(Code/1000); Buzz(1);
for (j = 0; j < 50; j++) Display_7seg(Code/100); Buzz(1);
for (j = 0; j < 50; j++) Display_7seg(Code/10); Buzz(1);
for (j = 0; j < 50; j++) Display_7seg(Code/1); Buzz(1);
//for (j = 0; j < 50; j++) Display_7seg(0); Buzz(1);
CloseSevenSegment();

printS_5x7(10,56,"Press Any Key To reStart!");
keyin=ScanKey();
while(keyin==0) { keyin=ScanKey();}
clear_LCD();
goto flage;
}

uint8_t numBulls(uint8_t guess[], uint8_t code[]) {
uint8_t numB = 0;
int k=0;
while (1) {
if (guess[k] == code[k]) {
numB++;
}
k++;
if(k==4)break;
}
return numB;
}

uint8_t numCows(uint8_t guess[], uint8_t code[]) {
uint8_t numC = 0;
int l=0;
int j=0;
while (1) {
j=0;
while (1) {
if (guess[l] == code[j] && l != j) {
numC++;
}
j++;
if(j==4)break;
}
l++;
if(l==4)break;
}
return numC;
}

// this is the Buzz function
// @para number: number of buzz sound.
void Buzz(int number)
{
int i;
for (i=0; i<number; i++) {
    PB11=0; // PB11 = 0 to turn on Buzzer
 CLK_SysTickDelay(100000); // Delay
 PB11=1; // PB11 = 1 to turn off Buzzer
 CLK_SysTickDelay(100000); // Delay
}
}

int x;

void winSound(){
Buzz(1);
CLK_SysTickDelay(3*delay);
Buzz(3);
CLK_SysTickDelay(1*delay);
Buzz(1);
//CLK_SysTickDelay(15*delay);
for(x = 0; x < 3; x++){ CLK_SysTickDelay(delay-100000); }
Buzz(1);
CLK_SysTickDelay(1*delay);
Buzz(1);
}

// display an integer on four 7-segment LEDs
void Display_7seg(uint16_t value)
{
  uint8_t digit;
digit = value / 1000;
CloseSevenSegment();
ShowSevenSegment(3,digit);
CLK_SysTickDelay(5000);

value = value - digit * 1000;
digit = value / 100;
CloseSevenSegment();
ShowSevenSegment(2,digit);
CLK_SysTickDelay(5000);

value = value - digit * 100;
digit = value / 10;
CloseSevenSegment();
ShowSevenSegment(1,digit);
CLK_SysTickDelay(5000);

value = value - digit * 10;
digit = value;
CloseSevenSegment();
ShowSevenSegment(0,digit);
CLK_SysTickDelay(5000);
}


void getUserInput(uint8_t keyin, uint8_t* code, char *Text5, int* Code){
	int i;
	keyin = 0;
	while(1){
		while(keyin == 0){
			keyin = ScanKey();
		}
		code[i] = keyin;
		sprintf(Text5,"%d%d%d%d", code[0],code[1],code[2],code[3]); // print scankey input to string
		print_Line(1, Text5);         // display string on LCD
		CLK_SysTickDelay(500000);   // delay
		keyin = 0;
		++i;
		if(i==4){
			*Code = code[0]*1000 + code[1]*100 + code[2]*10 + code[3]*1;
			break;
		}
	}
}

